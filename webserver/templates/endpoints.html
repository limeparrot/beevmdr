<!DOCTYPE html>
<html>
<head>
    <title>BeeVMDR - Endpoints Information</title>
    <style>
        :root {
            --sidebar-width: 200px;
            --main-padding: 20px;
            --accent-color: #64ffda;
            --dark-blue: #0a192f;
            --medium-blue: #1e2a4a;
            --light-blue: #ccd6f6;
            --purple: #483d8b;
        }
        
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            background-color: var(--dark-blue);
            color: var(--light-blue);
            display: flex;
            min-height: 100vh;
        }
        
        /* Сайдбар меню */
        .sidebar {
            width: var(--sidebar-width);
            background-color: var(--medium-blue);
            padding: 20px 0;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
        }
        
        .sidebar-header {
            color: var(--accent-color);
            padding: 0 20px 20px;
            font-size: 1.5rem;
            font-weight: bold;
            border-bottom: 1px solid #303f60;
            margin-bottom: 20px;
        }
        
        .sidebar-menu {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .sidebar-menu li {
            padding: 12px 20px;
            transition: background-color 0.3s;
        }
        
        .sidebar-menu li:hover {
            background-color: #2c3d6b;
        }
        
        .sidebar-menu a {
            color: var(--light-blue);
            text-decoration: none;
            display: block;
        }
        
        .sidebar-menu .active {
            border-left: 3px solid var(--accent-color);
            background-color: #2c3d6b;
        }
        
        /* Основное содержимое */
        .main-content {
            flex: 1;
            padding: var(--main-padding);
        }
        
        .page-header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .app-title {
            color: var(--accent-color);
            font-size: 2rem;
            margin: 0;
        }
        
        table {
            border-collapse: collapse;
            width: 100%;
            margin-bottom: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }
        
        th {
            background-color: var(--purple);
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: bold;
        }
        
        td {
            background-color: var(--medium-blue);
            color: var(--light-blue);
            padding: 10px;
            border: 1px solid #303f60;
        }
        
        tr:hover td {
            background-color: #2c3d6b;
        }
        
        .pagination-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 10px;
        }
        
        body {
            background-color: #0a192f;  /* Тёмно-синий фон страницы */
            color: #e6f1ff;  /* Светлый текст для контраста */
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
        }
        
        h1 {
            color: #64ffda;  /* Мятный цвет для заголовка */
            text-align: center;
            margin-bottom: 30px;
        }
        
        table {
            border-collapse: collapse;
            width: 100%;
            margin-bottom: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }
        
        th {
            background-color: #483d8b;  /* Темно-фиолетовый для заголовков */
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: bold;
        }
        
        td {
            background-color: #1e2a4a;  /* Синий для ячеек */
            color: #ccd6f6;
            padding: 10px;
            border: 1px solid #303f60;  /* Границы ячеек */
        }
        
        tr:hover td {
            background-color: #2c3d6b;  /* Эффект при наведении */
        }
        
        .pagination {
            display: flex;
            justify-content: center;
            margin-top: 10px;
        }
        
        .pagination a, .pagination strong {
            color: #ccd6f6;
            padding: 8px 16px;
            margin: 0 4px;
            text-decoration: none;
            border-radius: 4px;
            transition: all 0.3s;
        }
        
        .pagination a {
            background-color: #1e2a4a;
            border: 1px solid #303f60;
        }
        
        .pagination a:hover {
            background-color: #2c3d6b;
        }
        
        .pagination strong {
            background-color: #483d8b;
            color: white;
        }
        
        .info-text {
            color: #8892b0;
            text-align: center;
            margin: 20px 0;
            font-size: 14px;
        }

        .pagination-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 10px;
        }
        
        .items-per-page {
            display: flex;
            align-items: center;
            color: #8892b0;
        }
        
        .items-per-page select {
            background-color: #1e2a4a;
            color: #ccd6f6;
            border: 1px solid #303f60;
            border-radius: 4px;
            padding: 6px 10px;
            margin: 0 8px;
            cursor: pointer;
        }
        
        .items-per-page select:hover {
            background-color: #2c3d6b;
        }
    </style>
</head>
<body>

    <!-- Боковое меню -->
    <div class="sidebar">
        <div class="sidebar-header">BeeVMDR</div>
        <ul class="sidebar-menu">
            <li><a href="/dashboard">Dashboard</a></li>
            <li class="active"><a href="/endpoints">Endpoints</a></li>
            <li><a href="/detections">Detections</a></li>
            <li><a href="/cve-base">CVE-base</a></li>
        </ul>
    </div>

    <!-- Основное содержимое -->
    <div class="main-content">
        <div class="page-header">
            <h1 class="app-title">Endpoints Information</h1>
        </div>

        <table class="table table-striped table-bordered">
            <thead class="table-dark">
                <tr>
                    <th>Имя компьютера</th>
                    <th>Операционная система</th>
                    <th>Имя последнего пользователя</th>
                    <th>IP-адрес</th>
                    <th>MAC-адрес</th>
                    <th>Время последнего обновления</th>
                    <th>Статус защиты</th>
                    <th>Число уязвимого ПО</th>
                </tr>
            </thead>
            <tbody>
                {% for endpoint in endpoints %}
                <tr>
                    <td>{{ endpoint.computer_name }}</td>
                    <td>{{ endpoint.os_name }}</td>
                    <td>{{ endpoint.last_user }}</td>
                    <td>{{ endpoint.ip_address }}</td>
                    <td>{{ endpoint.mac_address }}</td>
                    <td>{{ endpoint.last_update }}</td>
                    <td>{{ endpoint.protection_status }}</td>
                    <td>{{ endpoint.vulnerable_software_percent }}</td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="3" class="text-center">Нет данных для отображения</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <div class="pagination-container">
             <div class="items-per-page">
                <form method="get" action="{{ url_for('show_endpoints') }}">
                    Show:
                    <select name="per_page" onchange="this.form.submit()">
                        <option value="5" {% if endpoints.per_page == 5 %}selected{% endif %}>5</option>
                        <option value="10" {% if endpoints.per_page == 10 %}selected{% endif %}>10</option>
                        <option value="20" {% if endpoints.per_page == 20 %}selected{% endif %}>20</option>
                        <option value="50" {% if endpoints.per_page == 50 %}selected{% endif %}>50</option>
                    </select>
                    items per page
                    <input type="hidden" name="page" value="1">
                </form>
            </div>

            <div class="info-text">
                Showing items {{ (endpoints.page - 1) * endpoints.per_page + 1 }} to 
                {{ [endpoints.page * endpoints.per_page, endpoints.total]|min }} of 
                {{ endpoints.total }} total entries
            </div>   

            <div class="pagination">
                {% if endpoints.has_prev %}
                    <a href="{{ url_for('show_endpoints', page=endpoints.prev_num) }}">← Previous</a>
                {% endif %}

                {% for page_num in endpoints.iter_pages(left_edge=1, right_edge=1, left_current=1, right_current=2) %}
                    {% if page_num %}
                        {% if endpoints.page == page_num %}
                            <strong>{{ page_num }}</strong>
                        {% else %}
                            <a href="{{ url_for('show_endpoints', page=page_num) }}">{{ page_num }}</a>
                        {% endif %}
                    {% else %}
                        <span class="ellipsis">...</span>
                    {% endif %}
                {% endfor %}

                {% if endpoints.has_next %}
                    <a href="{{ url_for('show_endpoints', page=endpoints.next_num) }}">Next →</a>
                {% endif %}
            </div>
        </div>
    </div>    
</body>
</html>
